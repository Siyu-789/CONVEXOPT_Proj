"0","# different size"
"0","alpha <- 0.01"
"0","beta <- 0.5"
"0","max_k <- 5"
"0","eta <- 0.1"
"0",""
"0","m <- 20"
"0","n <- 10"
"0","# initialization"
"0","x <- rep(0, n)"
"0","A <- matrix(runif(m * n), nrow = m)"
"0",""
"0","Ax <- A %*% x"
"0",""
"0","# storage"
"0","values <- numeric(max_k)"
"0","grad_norms <- numeric(max_k) "
"0",""
"0","# for loop"
"0","for (k in 1:max_k) {"
"0","  # f(x)"
"0","  val <- -sum(log(1 - Ax)) - sum(log(1 + x)) - sum(log(1 - x))"
"0","  "
"0","  # Df(x)"
"0","  grad <- t(A) %*% (1 / (1 - Ax)) - 1 / (1 + x) - 1 / (1 - x)"
"0","  "
"0","  # store iteration values"
"0","  grad_norm <- norm(grad, type=""2"")"
"0","  values[k] <- val"
"0","  grad_norms[k] <- grad_norm"
"0","  "
"0","  # stop statement: ||Df(x)||_2 \leq \eta"
"0","  if (grad_norm < eta) {"
"0","    values <- values[1:k]  "
"0","    grad_norms <- grad_norms[1:k] "
"0","    break"
"0","  }"
"0","  "
"0","  # direction of gradient method"
"0","  v <- -grad"
"0","  "
"0","  # backtracking line search: loop for t"
"0","  t <- 1"
"0","  while (max(A %*% (x + t * v)) >= 1 || max(abs(x + t * v)) >= 1) {"
"0","    t <- beta * t"
"0","  }"
"0","  "
"0","  # Ensure to update Ax only once per iteration"
"0","  new_x <- x + t * v"
"0","  new_Ax <- A %*% new_x"
"0","  "
"0","  while (-sum(log(1 - new_Ax)) - sum(log(1 + new_x)) - sum(log(1 - new_x)) > val + alpha * t * sum(grad * v)) {"
"0","    t <- beta * t"
"0","    new_x <- x + t * v"
"0","    new_Ax <- A %*% new_x"
"0","  }"
"0","  "
"0","  # iteration"
"0","  x <- new_x"
"0","  Ax <- new_Ax"
"0","  "
"0","  # Optionally print progress"
"0","  cat(""k:"", k, ""Value:"", val, ""\n"")"
"0","}"
"1","k:"
"1"," "
"1","1"
"1"," "
"1","Value:"
"1"," "
"1","0"
"1"," "
"1","
"
"1","k:"
"1"," "
"1","2"
"1"," "
"1","Value:"
"1"," "
"1","-21.48762"
"1"," "
"1","
"
"1","k:"
"1"," "
"1","3"
"1"," "
"1","Value:"
"1"," "
"1","-22.50419"
"1"," "
"1","
"
"1","k:"
"1"," "
"1","4"
"1"," "
"1","Value:"
"1"," "
"1","-22.50419"
"1"," "
"1","
"
"1","k:"
"1"," "
"1","5"
"1"," "
"1","Value:"
"1"," "
"1","-22.50419"
"1"," "
"1","
"
"0","plot(values, type = 'b', col = 'blue', xlab = 'k', ylab = 'Objective function value', main = 'Objective Function During Gradient Descent')"
