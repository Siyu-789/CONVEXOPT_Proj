"0","alpha <- 0.01"
"0","beta <- 0.5"
"0","max_k <- 5"
"0","eta <- 0.0001"
"0",""
"0","m <- 20"
"0","n <- 10"
"0","# initialization"
"0","x <- rep(0, n)"
"0","A <- matrix(runif(m * n), nrow = m)"
"0",""
"0","values <- numeric(max_k)"
"0",""
"0","for (k in 1:max_k) {"
"0","  # f(x)"
"0","  Ax <- A %*% x"
"0","  val <- -sum(log(1 - Ax)) - sum(log(1 + x)) - sum(log(1 - x))"
"0","  "
"0","  values[k] <- val"
"0","   "
"0","  # Df(x)"
"0","  d <- 1 / (1 - Ax)"
"0","  grad <- t(A) %*% d - 1 / (1 + x) + 1 / (1 - x)"
"0","  "
"0","  # Hessian matrix"
"0","  H <- t(A) %*% diag(as.vector(d^2)) %*% A + diag(as.vector(1 / (1 + x)^2)) + diag(as.vector(1 / (1 - x)^2))"
"0","  "
"0","  # Newton step"
"0","  v <- solve(H, grad)"
"0","  "
"0","  # Newton decrement"
"0","  fprime <- sum(grad * v)"
"0","  "
"0","  # Check for stopping criterion"
"0","  if (abs(fprime) < eta) {"
"0","    values <- values[1:k]  # Adjust the length of values vector"
"0","    break"
"0","  }"
"0","  "
"0","  # Line search"
"0","  t <- 1"
"0","  while (max(A %*% (x + t * v)) >= 1 || max(abs(x + t * v)) >= 1) {"
"0","    t <- beta * t"
"0","  }"
"0","  "
"0","  new_x <- x + t * v"
"0","  new_Ax <- A %*% new_x"
"0","  "
"0","  while (-sum(log(1 - new_Ax)) - sum(log(1 + new_x)) - sum(log(1 - new_x)) > val + alpha * t * fprime) {"
"0","    t <- beta * t"
"0","    new_x <- x + t * v"
"0","    new_Ax <- A %*% new_x"
"0","  }"
"0","  "
"0","  # Update x"
"0","  x <- new_x"
"0","  "
"0","  # Optionally print progress"
"0","  print(paste(""Iteration:"", k, ""Value:"", val))  # Use `k` instead of `iter`"
"0","}"
"1","[1]"
"1"," ""Iteration: 1 Value: 0"""
"1","
"
"1","[1]"
"1"," ""Iteration: 2 Value: 0"""
"1","
"
"1","[1]"
"1"," ""Iteration: 3 Value: 0"""
"1","
"
"1","[1]"
"1"," ""Iteration: 4 Value: 0"""
"1","
"
"1","[1]"
"1"," ""Iteration: 5 Value: 0"""
"1","
"
"0","# Plot the objective function value by iteration"
"0","if (k == 1) { values <- values[1] }  # If only one iteration is performed"
"0","plot(1:k, values, type = 'b', col = 'blue', xlab = 'k', ylab = 'f(x^k)')"
